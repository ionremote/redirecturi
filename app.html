<html><head></head><body>
<p>Please wait while we redirect you to your app</p>
<p><a href="javascript:redirectToApp()">Click Here to return to app</a></p>
<script>
  var redirectToApp = function() {
    //var scheme = "com.google.codelabs.appauth";
    const params = new URLSearchParams(window.location.search);
    //const scheme = params.get('scheme');
    var scheme = "com.omni.ion.sonos";
    var openURL = "oauth2callback" + window.location.pathname + window.location.search + window.location.hash;
    var iOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
    var Android = /Android/.test(navigator.userAgent);
    var newLocation;
    if (iOS) {
      newLocation = scheme + ":" + openURL;
    } else if (Android) {
      newLocation = "intent://" + openURL + "#Intent;scheme=" + scheme + ";package=com.com.ion;end";
    } else {
      newLocation = scheme + "://" + openURL;
    }
    console.log(newLocation)
    window.location.replace(newLocation);
  }
  
  function GetURLParameter(sParam)
  {
    var sPageURL = window.location.search.substring(1);
    var sURLVariables = sPageURL.split('&');
    for (var i = 0; i < sURLVariables.length; i++) 
    {
        var sParameterName = sURLVariables[i].split('=');
        if (sParameterName[0] == sParam) 
        {
            return sParameterName[1];
        }
    }
  }â€‹
  window.onload = redirectToApp;
  document.write(GetURLParameter("scheme")) ;
  alert("END");
</script>


</body></html>
